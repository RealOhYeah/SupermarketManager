"use strict";(self["webpackChunksupermarket_manager"]=self["webpackChunksupermarket_manager"]||[]).push([[790],{5790:function(e,t,r){r.r(t),r.d(t,{default:function(){return u}});var a=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"sale_records"}},[t("el-breadcrumb",{attrs:{separator:"/"}},[t("el-breadcrumb-item",[e._v("首页")]),t("el-breadcrumb-item",[e._v("销售管理")]),t("el-breadcrumb-item",[e._v("销售记录")])],1),t("br"),t("el-row",[t("el-col",{attrs:{span:4}},[t("el-input",{staticStyle:{height:"21px",width:"300px"},attrs:{placeholder:"销售编号"},model:{value:e.searchForm.cn,callback:function(t){e.$set(e.searchForm,"cn",t)},expression:"searchForm.cn"}})],1),t("el-col",{attrs:{span:10}},[t("span",[e._v("销售时间：")]),t("el-date-picker",{staticStyle:{width:"140px"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"起始时间"},model:{value:e.searchForm.startSellTime,callback:function(t){e.$set(e.searchForm,"startSellTime",t)},expression:"searchForm.startSellTime"}}),e._v(" - "),t("el-date-picker",{staticStyle:{width:"140px"},attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"结束时间"},model:{value:e.searchForm.endSellTime,callback:function(t){e.$set(e.searchForm,"endSellTime",t)},expression:"searchForm.endSellTime"}})],1),t("el-col",{attrs:{span:4}},[t("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"顾客类型",clearable:""},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.searchForm.type,callback:function(t){e.$set(e.searchForm,"type",t)},expression:"searchForm.type"}},[t("el-option",{attrs:{label:"非会员顾客",value:"0"}}),t("el-option",{attrs:{label:"会员",value:"1"}})],1)],1),t("el-col",{attrs:{span:4}},[t("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"支付方式",clearable:""},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.searchForm.sellway,callback:function(t){e.$set(e.searchForm,"sellway",t)},expression:"searchForm.sellway"}},[t("el-option",{attrs:{label:"支付宝",value:"0"}}),t("el-option",{attrs:{label:"微信",value:"1"}}),t("el-option",{attrs:{label:"现金",value:"2"}}),t("el-option",{attrs:{label:"银行卡",value:"3"}})],1)],1)],1),t("br"),t("el-row",[t("el-col",{staticStyle:{"text-align":"left"},attrs:{span:24}},[t("el-button",{staticStyle:{"font-size":"18px"},attrs:{type:"success"},on:{click:e.submitSearchForm}},[t("i",{staticClass:"iconfont icon-r-find",staticStyle:{"font-size":"18px"}}),e._v(" 搜索")])],1)],1),t("br"),t("div",{staticClass:"table"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"medium"}},[t("el-table-column",{attrs:{prop:"cn",width:"200",label:"编号"}}),t("el-table-column",{attrs:{prop:"sellTotal",label:"销售数量"}}),t("el-table-column",{attrs:{prop:"sellTotalmoney",label:"销售总额"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(parseFloat(t.row.sellTotalmoney).toFixed(2))+" ")]}}])}),t("el-table-column",{attrs:{prop:"sellTime","show-overflow-tooltip":!0,label:"销售时间"}}),t("el-table-column",{attrs:{prop:"type",label:"顾客类型",width:"120"},scopedSlots:e._u([{key:"default",fn:function(r){return["1"==r.row.type?t("el-tag",{staticStyle:{"font-size":"14px"},attrs:{effect:"dark",type:"warning"}},[t("i",{staticClass:"iconfont icon-r-mark1"}),e._v(" 会员")]):t("el-tag",{attrs:{effect:"dark",type:"info"}},[e._v("非会员")])]}}])}),t("el-table-column",{attrs:{prop:"sellby",label:"销售员"}}),t("el-table-column",{attrs:{prop:"sellway",label:"支付方式"},scopedSlots:e._u([{key:"default",fn:function(r){return["0"==r.row.sellway?t("el-tag",{attrs:{effect:"dark",type:"primary"}},[e._v("支付宝")]):"1"==r.row.sellway?t("el-tag",{attrs:{effect:"dark",type:"success"}},[e._v("微信")]):"3"==r.row.sellway?t("el-tag",{attrs:{effect:"dark",type:"warning"}},[e._v("银行卡")]):t("el-tag",{attrs:{effect:"dark",type:"danger"}},[e._v("现金")])]}}])}),t("el-table-column",{attrs:{prop:"info","show-overflow-tooltip":!0,label:"备注"}}),t("el-table-column",{attrs:{width:"240",label:"操作",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-button",{staticStyle:{"font-size":"18px"},attrs:{type:"success"},on:{click:function(t){return e.detailBtn(r.row)}}},[t("i",{staticClass:"iconfont icon-r-find",staticStyle:{"font-size":"18px"}}),e._v(" 明细 ")]),t("el-button",{staticStyle:{"font-size":"18px"},attrs:{type:"danger"},on:{click:function(t){return e.del(r.row.cn)}}},[t("i",{staticClass:"iconfont icon-r-delete",staticStyle:{"font-size":"18px"}}),e._v(" 删除 ")])]}}])})],1),t("div",{staticStyle:{margin:"10px 0 15px 0"}},[t("el-pagination",{attrs:{"current-page":e.searchForm.currentPage,"page-sizes":[5,10,20,50],"page-size":e.searchForm.pageSize,layout:"total,sizes, prev, pager, next,jumper",total:e.searchForm.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){return e.$set(e.searchForm,"currentPage",t)},"update:current-page":function(t){return e.$set(e.searchForm,"currentPage",t)}}})],1)],1),t("el-dialog",{attrs:{title:"销售订单明细",visible:e.detailSaleRecordsVisable,width:"80%"},on:{"update:visible":function(t){e.detailSaleRecordsVisable=t}}},[t("el-form",{staticClass:"demo-ruleForm",attrs:{model:e.saleRecordForm,"label-width":"100px"}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{staticStyle:{width:"60%"},attrs:{label:"销售编号："}},[t("el-input",{attrs:{disabled:"",readonly:"",placeholder:"如：销售编号"},model:{value:e.saleRecordForm.cn,callback:function(t){e.$set(e.saleRecordForm,"cn",t)},expression:"saleRecordForm.cn"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{staticStyle:{width:"80%"},attrs:{label:"支付方式：",prop:"sellway"}},[t("el-radio",{attrs:{disabled:"",type:"radio",label:"0"},model:{value:e.saleRecordForm.sellway,callback:function(t){e.$set(e.saleRecordForm,"sellway",t)},expression:"saleRecordForm.sellway"}},[e._v("支付宝")]),t("el-radio",{attrs:{disabled:"",type:"radio",label:"1"},model:{value:e.saleRecordForm.sellway,callback:function(t){e.$set(e.saleRecordForm,"sellway",t)},expression:"saleRecordForm.sellway"}},[e._v("微信")]),t("el-radio",{attrs:{disabled:"",type:"radio",label:"2"},model:{value:e.saleRecordForm.sellway,callback:function(t){e.$set(e.saleRecordForm,"sellway",t)},expression:"saleRecordForm.sellway"}},[e._v("现金")]),t("el-radio",{attrs:{disabled:"",type:"radio",label:"3"},model:{value:e.saleRecordForm.sellway,callback:function(t){e.$set(e.saleRecordForm,"sellway",t)},expression:"saleRecordForm.sellway"}},[e._v("银行卡")])],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{staticStyle:{width:"60%"},attrs:{label:"顾客类型："}},[t("el-radio",{attrs:{disabled:"",type:"radio",label:"1"},model:{value:e.saleRecordForm.type,callback:function(t){e.$set(e.saleRecordForm,"type",t)},expression:"saleRecordForm.type"}},[e._v("会员")]),t("el-radio",{attrs:{disabled:"",type:"radio",label:"0"},model:{value:e.saleRecordForm.type,callback:function(t){e.$set(e.saleRecordForm,"type",t)},expression:"saleRecordForm.type"}},[e._v("非会员")])],1)],1),"1"==e.saleRecordForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{staticStyle:{width:"60%"},attrs:{label:"会员账号：",prop:"memberPhone"}},[t("el-input",{attrs:{readonly:"",placeholder:"如：电话号码"},model:{value:e.saleRecordForm.memberPhone,callback:function(t){e.$set(e.saleRecordForm,"memberPhone",t)},expression:"saleRecordForm.memberPhone"}})],1)],1):e._e()],1),t("hr"),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.saleRecordForm.detailSaleRecords,size:"medium"}},[t("el-table-column",{attrs:{prop:"goodsId",label:"商品编号"}}),t("el-table-column",{attrs:{prop:"goodsName",label:"商品名"}}),t("el-table-column",{attrs:{prop:"goodsNum",label:"数量"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-button",{attrs:{type:"info",disabled:""}},[e._v("-")]),t("el-input",{staticStyle:{width:"80px"},attrs:{disabled:"",type:"number",min:"1"},model:{value:r.row.goodsNum,callback:function(t){e.$set(r.row,"goodsNum",t)},expression:"scope.row.goodsNum"}}),t("el-button",{attrs:{type:"info",disabled:""}},[e._v("+")])]}}])}),t("el-table-column",{attrs:{prop:"goodsPrice",label:"商品单价（元）"}})],1)],1)],1),t("hr"),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"备注："}},[t("el-input",{attrs:{disabled:"",readonly:"",type:"textarea",placeholder:"如：订单1"},model:{value:e.saleRecordForm.info,callback:function(t){e.$set(e.saleRecordForm,"info",t)},expression:"saleRecordForm.info"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:24}},[e.saleRecordForm.detailSaleRecords.length>0?t("div",[e._v(" 订单号："+e._s(e.saleRecordForm.cn)+"   商品总数："+e._s(e.saleRecordForm.sellTotal?e.saleRecordForm.sellTotal:0)+"   消费："+e._s(e.saleRecordForm.sellTotalmoney?parseFloat(e.saleRecordForm.sellTotalmoney).toFixed(2):0)+"元   "),e.saleRecordForm.sellway?t("span",[e._v("支付方式："+e._s("0"==e.saleRecordForm.sellway?"支付宝":"1"==e.saleRecordForm.sellway?"微信":"2"==e.saleRecordForm.sellway?"现金":"银行卡")+"  ")]):e._e(),t("br"),"1"==e.saleRecordForm.type?t("span",[e._v("会员享受9折  ")]):e._e(),e.saleRecordForm.sellTime?t("span",[e._v("消费时间："+e._s(e.saleRecordForm.sellTime)+"   操作者编号："+e._s(e.saleRecordForm.eid))]):e._e()]):e._e()])],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",[t("el-button",{attrs:{type:"info"},on:{click:function(t){e.detailSaleRecordsVisable=!1}}},[e._v("关闭")])],1)],1)],1)],1)],1)],1)},l=[],o=r(8151),s=r(9183),n={data(){return{detailSaleRecordsVisable:!1,searchForm:{pageSize:5},tableData:[],saleRecordForm:{cn:"",sellway:"",info:"",sellTotal:"",sellTotalmoney:"",type:"0",detailSaleRecords:[]}}},methods:{init(){this.searchForm.startSellTime>this.searchForm.endSellTime?(0,o.gk)("结束时间不能小于开始时间","warning"):(0,s.Bp)(this.searchForm).then((e=>{e=e.data,200==e.code?(this.tableData=e.data.records,this.searchForm.total=e.data.total,this.searchForm.pageSize=e.data.size,this.searchForm.currentPage=e.data.current):(0,o.gk)(e.msg,"error")}))},del(e){this.$confirm("确定删除这条记录？","警示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{(0,s.lk)({cn:e}).then((e=>{e=e.data,200==e.code?((0,o.gk)("操作成功"),this.init()):(0,o.gk)(e.msg,"error")}))})).catch((()=>{this.$message({type:"info",message:"已取消操作"})}))},detailBtn(e){this.saleRecordForm={cn:"",sellway:"",info:"",sellTotal:"",sellTotalmoney:"",type:"0",detailSaleRecords:[]},this.saleRecordForm={...e},this.detailSaleRecordsVisable=!0},handleSizeChange(e){this.searchForm.pageSize=e,this.init(),console.log(`每页 ${e} 条`)},handleCurrentChange(e){this.searchForm.currentPage=e,this.init(),console.log(`当前页: ${e}`)},submitSearchForm(){this.init()}},mounted(){this.init()}},c=n,i=r(3736),d=(0,i.Z)(c,a,l,!1,null,null,null),u=d.exports},9183:function(e,t,r){r.d(t,{Bp:function(){return c},Mg:function(){return n},PA:function(){return s},lk:function(){return i},sJ:function(){return o}});var a=r(8151);const l="/sale_management/sale_record";function o(){return(0,a.Ck)(l+"/getCn",{})}function s(){return(0,a.Ck)(l+"/getOptionSaleRecordsGoods",{})}function n(e){return(0,a.ml)(l+"/saveSaleRecords",e)}function c(e){return(0,a.tB)(l+"/queryPageByQoSaleRecords",e)}function i(e){return(0,a.Ck)(l+"/delSaleRecords",e)}},9253:function(e,t,r){r.d(t,{LP:function(){return o},Nx:function(){return n},_5:function(){return c},gy:function(){return s}});var a=r(4858);const l="token";function o(){return a.Z.get(l)}function s(){return a.Z.remove(l)}function n(){let e=a.Z.get("employee");return JSON.parse(e)}function c(e){a.Z.remove(e)}},8151:function(e,t,r){r.d(t,{Ck:function(){return m},gk:function(){return f},ml:function(){return p},tB:function(){return u}});var a=r(9253),l=r(6154),o=r(4720),s=r(4858),n=r(129),c=r.n(n);const i="http://192.168.88.132:9291";function d(){var e=(0,a.LP)();return e&&(0,l.Z)({url:i+"/checkedToken",method:"GET",params:{token:e}}).then((e=>{e=e.data,200==e.code&&(s.Z.set("token",e.data.token,{expires:1/48}),s.Z.set("employee",JSON.stringify(e.data.employee),{expires:1/48}))})).catch((e=>{console.log(e)})),e}function u(e,t){return(0,l.Z)({url:i+e,method:"POST",headers:{token:d()},data:c().stringify(t)}).catch((e=>{console.log(e),void 0==e.response||void 0==e.response.data?f(e,"error"):f(e.response.data,"error")}))}function p(e,t){return(0,l.Z)({url:i+e,method:"POST",headers:{"Content-Type":"application/json",token:d()},data:t}).catch((e=>{console.log(e),void 0==e.response||void 0==e.response.data?f(e,"error"):f(e.response.data,"error")}))}function m(e,t){return(0,l.Z)({url:i+e,method:"GET",headers:{token:d()},params:t}).catch((e=>{console.log(e),void 0==e.response||void 0==e.response.data?f(e,"error"):f(e.response.data,"error")}))}function f(e,t){switch(t){case"warning":o.Message.warning(e);break;case"error":o.Message.error({message:e,duration:5e3,showClose:!0});break;case"info":o.Message.info(e);break;default:o.Message.success(e)}}},4858:function(e,t){
/*! js-cookie v3.0.1 | MIT */
function r(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)e[a]=r[a]}return e}var a={read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function l(e,t){function a(a,l,o){if("undefined"!==typeof document){o=r({},t,o),"number"===typeof o.expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),a=encodeURIComponent(a).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var n in o)o[n]&&(s+="; "+n,!0!==o[n]&&(s+="="+o[n].split(";")[0]));return document.cookie=a+"="+e.write(l,a)+s}}function o(t){if("undefined"!==typeof document&&(!arguments.length||t)){for(var r=document.cookie?document.cookie.split("; "):[],a={},l=0;l<r.length;l++){var o=r[l].split("="),s=o.slice(1).join("=");try{var n=decodeURIComponent(o[0]);if(a[n]=e.read(s,n),t===n)break}catch(c){}}return t?a[t]:a}}return Object.create({set:a,get:o,remove:function(e,t){a(e,"",r({},t,{expires:-1}))},withAttributes:function(e){return l(this.converter,r({},this.attributes,e))},withConverter:function(e){return l(r({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}})}var o=l(a,{path:"/"});t["Z"]=o}}]);
//# sourceMappingURL=790.760132640a8702ad.1727173273753.js.map